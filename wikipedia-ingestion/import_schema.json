{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Wikipedia Ingestion Import Schema",
  "description": "JSON schema for timeline ingestion output artifacts from Wikipedia strategy runners",
  "type": "object",
  "required": [
    "strategy",
    "run_id",
    "generated_at_utc",
    "event_count",
    "metadata",
    "events"
  ],
  "properties": {
    "strategy": {
      "type": "string",
      "description": "Name of the ingestion strategy (e.g., 'TimelineOfFood', 'TimelineOfRomanHistory')"
    },
    "run_id": {
      "type": "string",
      "description": "Unique identifier for this ingestion run (typically timestamp in format YYYYMMDDTHHMMSSZ)",
      "pattern": "^\\d{8}T\\d{6}Z$"
    },
    "generated_at_utc": {
      "type": "string",
      "description": "ISO 8601 timestamp when the artifact was generated",
      "format": "date-time"
    },
    "event_count": {
      "type": "integer",
      "description": "Total number of events extracted in this run",
      "minimum": 0
    },
    "metadata": {
      "type": "object",
      "description": "Metadata about the ingestion run",
      "required": [
        "total_events_found",
        "total_events_parsed",
        "sections_identified",
        "parsing_start_utc",
        "parsing_end_utc",
        "elapsed_seconds",
        "events_per_second",
        "confidence_distribution",
        "undated_events"
      ],
      "properties": {
        "total_events_found": {
          "type": "integer",
          "description": "Total number of events discovered in the source",
          "minimum": 0
        },
        "total_events_parsed": {
          "type": "integer",
          "description": "Total number of events successfully parsed",
          "minimum": 0
        },
        "sections_identified": {
          "type": "integer",
          "description": "Number of hierarchical sections/subsections identified in the source",
          "minimum": 0
        },
        "parsing_start_utc": {
          "type": "string",
          "description": "ISO 8601 timestamp when parsing began",
          "format": "date-time"
        },
        "parsing_end_utc": {
          "type": "string",
          "description": "ISO 8601 timestamp when parsing completed",
          "format": "date-time"
        },
        "elapsed_seconds": {
          "type": "number",
          "description": "Total elapsed time for parsing in seconds",
          "minimum": 0
        },
        "events_per_second": {
          "type": "number",
          "description": "Throughput metric: events parsed per second",
          "minimum": 0
        },
        "confidence_distribution": {
          "type": "object",
          "description": "Distribution of confidence levels across parsed events",
          "required": [
            "explicit",
            "inferred",
            "approximate",
            "contentious",
            "fallback"
          ],
          "properties": {
            "explicit": {
              "type": "integer",
              "description": "Events with explicit, unambiguous dates from the source",
              "minimum": 0
            },
            "inferred": {
              "type": "integer",
              "description": "Events with dates inferred from hierarchical context",
              "minimum": 0
            },
            "approximate": {
              "type": "integer",
              "description": "Events with approximate or uncertain dates (circa, mid-, etc.)",
              "minimum": 0
            },
            "contentious": {
              "type": "integer",
              "description": "Events with contested or debated dates",
              "minimum": 0
            },
            "fallback": {
              "type": "integer",
              "description": "Events parsed using fallback/alternative parsing methods",
              "minimum": 0
            }
          }
        },
        "undated_events": {
          "type": "object",
          "description": "Summary of events without parseable dates",
          "required": [
            "total_undated",
            "events"
          ],
          "properties": {
            "total_undated": {
              "type": "integer",
              "description": "Total count of events with no parseable date",
              "minimum": 0
            },
            "events": {
              "type": "array",
              "description": "List of undated events (if captured)",
              "items": {
                "type": "object"
              }
            }
          }
        }
      }
    },
    "events": {
      "type": "array",
      "description": "Array of extracted historical events",
      "items": {
        "type": "object",
        "required": [
          "title",
          "start_year",
          "end_year",
          "is_bc_start",
          "is_bc_end",
          "precision",
          "weight",
          "url",
          "span_match_notes",
          "description",
          "category"
        ],
        "properties": {
          "title": {
            "type": "string",
            "description": "Event title (typically first 50-70 characters of description)"
          },
          "start_year": {
            "type": "integer",
            "description": "Start year of the event (absolute value; BC dates are also positive integers)"
          },
          "end_year": {
            "type": "integer",
            "description": "End year of the event (for range events; same as start_year for point events)"
          },
          "is_bc_start": {
            "type": "boolean",
            "description": "Whether the start year is BC (true) or AD (false)"
          },
          "is_bc_end": {
            "type": "boolean",
            "description": "Whether the end year is BC (true) or AD (false)"
          },
          "start_month": {
            "type": [
              "integer",
              "null"
            ],
            "description": "Month of event start (1-12) or null if not specified",
            "minimum": 1,
            "maximum": 12
          },
          "start_day": {
            "type": [
              "integer",
              "null"
            ],
            "description": "Day of event start (1-31) or null if not specified",
            "minimum": 1,
            "maximum": 31
          },
          "end_month": {
            "type": [
              "integer",
              "null"
            ],
            "description": "Month of event end (1-12) or null if not specified",
            "minimum": 1,
            "maximum": 12
          },
          "end_day": {
            "type": [
              "integer",
              "null"
            ],
            "description": "Day of event end (1-31) or null if not specified",
            "minimum": 1,
            "maximum": 31
          },
          "precision": {
            "type": "number",
            "description": "Precision factor for the date (0 = precise, higher values indicate less precise dates)",
            "minimum": 0,
            "maximum": 100
          },
          "weight": {
            "type": "integer",
            "description": "Weight/importance metric for the event (related to date precision and span)",
            "minimum": 0
          },
          "url": {
            "type": "string",
            "description": "Source URL from which the event was extracted",
            "format": "uri"
          },
          "span_match_notes": {
            "type": "string",
            "description": "Parsing notes indicating the span/text that matched for date extraction"
          },
          "description": {
            "type": "string",
            "description": "Full event description from the source"
          },
          "category": {
            "type": "string",
            "description": "Category assigned to this event (e.g., 'Food History', 'Roman History')"
          },
          "_debug_extraction": {
            "type": [
              "string",
              "null"
            ],
            "description": "Optional debug information about the extraction process"
          }
        }
      }
    }
  }
}
